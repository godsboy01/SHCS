<view class="page">
  <!-- 顶部导航栏 -->
  <view class="nav-bar">
    <view class="nav-bar-content">
      <!-- 返回按钮 -->
      <view class="back-btn" bindtap="handleBack">
        <text class="back-icon">←</text>
      </view>
      <!-- 设备信息 -->
      <view class="device-info">
        <view class="device-name">{{deviceInfo.name}}</view>
        <view class="device-location">{{deviceInfo.location}}</view>
      </view>
    </view>
  </view>

  <!-- 主要内容区域 -->
  <view class="container">
    <!-- 时间显示 -->
    <view class="time-display">
      <text class="time-text">{{currentTime}}</text>
    </view>

    <!-- 视频显示区域 -->
    <view class="video-container {{isPlaying ? 'playing' : ''}}">
      <image wx:if="{{isPlaying && videoSrc}}" 
             src="{{videoSrc}}" 
             mode="aspectFit" 
             class="video-stream"/>
      <view wx:if="{{isLoading}}" class="loading">加载中...</view>
      <view wx:if="{{errorMessage}}" class="error">{{errorMessage}}</view>
      <view wx:if="{{!isPlaying}}" class="placeholder">
        <text>点击下方按钮开始监控</text>
      </view>
    </view>

    <!-- 控制按钮 -->
    <view class="controls">
      <button class="control-btn {{isPlaying ? 'playing' : ''}}" 
              bindtap="togglePlay">
        {{isPlaying ? '停止监控' : '开始监控'}}
      </button>
    </view>

    <!-- 警报提示 -->
    <view wx:if="{{alertLevel > 0}}" class="alert-container">
      <view class="alert-message">
        检测到异常行为！警报级别: {{alertLevel}}
      </view>
    </view>

    <!-- 截图展示区域 -->
    <view class="snapshots-container">
      <view class="section-title">异常行为记录</view>
      
      <!-- 跌倒截图 -->
      <view class="snapshot-section">
        <view class="sub-title">跌倒记录</view>
        <scroll-view scroll-x class="snapshot-scroll">
          <block wx:for="{{fallSnapshots}}" wx:key="path">
            <image src="http://127.0.0.1:5000{{item.path}}" 
                   mode="aspectFill" 
                   class="snapshot-image"/>
          </block>
        </scroll-view>
      </view>

      <!-- 坐下截图 -->
      <view class="snapshot-section">
        <view class="sub-title">坐下记录</view>
        <scroll-view scroll-x class="snapshot-scroll">
          <block wx:for="{{sitSnapshots}}" wx:key="path">
            <image src="http://127.0.0.1:5000{{item.path}}" 
                   mode="aspectFill" 
                   class="snapshot-image"/>
          </block>
        </scroll-view>
      </view>
    </view>
  </view>
</view>